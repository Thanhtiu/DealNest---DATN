(self.miniJsonp=self.miniJsonp||[]).push([[4997],{78232:function(e,r,t){var o;o=(e,r,t,o,n)=>(()=>{"use strict";var a={383:r=>{r.exports=e},975:e=>{e.exports=r},511:e=>{e.exports=t},644:e=>{e.exports=o},855:e=>{e.exports=n}},s={};function c(e){var r=s[e];if(void 0!==r)return r.exports;var t=s[e]={exports:{}};return a[e](t,t.exports,c),t.exports}c.d=(e,r)=>{for(var t in r)c.o(r,t)&&!c.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},c.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{c.r(i),c.d(i,{activeListTabSelector:()=>u,allConversationIdsSelector:()=>j,conversationBeenDeletedSelector:()=>ge,conversationDirectionSelector:()=>B,conversationHttpStatusSelector:()=>z,conversationIdsSelector:()=>M,conversationLastMessageSelector:()=>Ze,conversationsSelector:()=>F,curConvsMessageSelector:()=>cr,curMessagesRelatedSelector:()=>We,currentBuyerIdSelector:()=>W,currentBuyerSelector:()=>ce,currentBuyerShopIdSelector:()=>ie,currentBuyerShopSelector:()=>le,currentConversationBuyerIdSelectors:()=>ee,currentConversationCanReadSelector:()=>k,currentConversationHasLoadingSelector:()=>Le,currentConversationIdSelector:()=>U,currentConversationMaxOptionHideTimeSelectors:()=>te,currentConversationSelector:()=>Q,currentConversationShopIdSelectors:()=>$,currentConversationShopRegionSelectors:()=>Z,currentConversationShopSelectors:()=>X,currentConversationStatusSelectors:()=>re,currentConversationToNameSelector:()=>fe,currentConversationTranslationAccessSelector:()=>Se,currentPendingOffersCountSelector:()=>_e,currentSellerAccountIdSelector:()=>Oe,currentShopIdSelector:()=>se,defaultCount:()=>Ie,degradeConversationIdsSelector:()=>H,feedbackSelector:()=>vr,filterSelector:()=>J,filteredConversationsSelector:()=>K,getConversation:()=>oe,getConversationPendingOffersCountSelector:()=>be,getConversationShopId:()=>ne,getConversationShopRegion:()=>Re,getConversations:()=>ae,getConversationsSelector:()=>b,getConvsMessagesRelatedSelector:()=>Xe,getMessageSelector:()=>Qe,hasPinFlagSelector:()=>p,inlocationSelector:()=>D,isNavigateToUnreadMessageSelector:()=>Te,keywordSelector:()=>de,listsHashSelector:()=>pe,mediaListSelector:()=>ur,messagesRelatedMapSelector:()=>He,missedReadNoticeCountSelector:()=>w,navigateToUnreadMessageIdSelector:()=>he,noticesCountSelector:()=>pr,pinnedConversationIdsSelector:()=>A,readRequestIdsSelector:()=>L,reconnectFlagSelector:()=>Sr,redirectionInfoSelector:()=>we,replyToMessageSelector:()=>dr,resultsSelector:()=>ue,reverseMessagesSelector:()=>or,searchConversationHttpStatusSelector:()=>ve,selectVideoInfoByKey:()=>Ke,selectVideoInfoKeyByVid:()=>qe,serveTodayAllConversationIdsSelector:()=>_,serveTodayAutoRepliedConversationIdsSelector:()=>h,serveTodayAutoRepliedConversationsSelector:()=>O,serveTodayConversationHttpStatusSelector:()=>g,serveTodayConversationsSelector:()=>E,serveTodayFolderStatusSelector:()=>v,serveTodayManuallyRepliedConversationIdsSelector:()=>C,serveTodayManuallyRepliedConversationsSelector:()=>I,serveTodayOnlyConversationsSelector:()=>P,serveTodayPinnedConversationIdsSelector:()=>m,serveTodayUnrepliedConversationIdsSelector:()=>T,serveTodayUnrepliedConversationsSelector:()=>R,serveTodayWaitingUpdatedRecordsSelector:()=>S,shopAccessSelector:()=>me,showFrozenTipSelector:()=>Ae,showLoadingMessagesMapSelector:()=>je,singleConversationIdsSelector:()=>y,singleConversationMarkInfoSelector:()=>Me,singleConversationStateSelector:()=>f,sortedConversationsSelector:()=>q,totalConversationsCountSelector:()=>Ee,twoTabsAllConversationIdsSelector:()=>De,updateTimeNowSelector:()=>N});var e=c(383),r=c(975),t=c(511),o=c(644);function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var a=c(855);function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var d=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.serveToday)||{}},u=(0,r.createSelector)(d,(e=>e.activeListTab)),v=(0,r.createSelector)(d,(e=>e.folderStatus)),S=(0,r.createSelector)(d,(e=>e.waitingUpdatedRecords||{})),p=(0,r.createSelector)(d,(e=>e.hasPinFlag||{})),g=(0,r.createSelector)(d,(e=>e.status||"")),f=e=>(0,r.createSelector)(d,(r=>r[e]||{})),y=e=>(0,r.createSelector)(f(e),(e=>e.conversationIds||[])),m=(0,r.createSelector)(d,(e=>(e[a.ServeTodayTab.PINNED]||{}).conversationIds||[])),T=(0,r.createSelector)(d,(e=>(e[a.ServeTodayTab.UNREPLIED]||{}).conversationIds||[])),h=(0,r.createSelector)(d,(e=>(e[a.ServeTodayTab.AUTOREPLY]||{}).conversationIds||[])),C=(0,r.createSelector)(d,(e=>(e[a.ServeTodayTab.MANUALREPLY]||{}).conversationIds||[])),_=(0,r.createSelector)(m,T,h,C,((e,r,t,o)=>[...e,...r,...t,...o])),b=n=>(0,r.createSelector)(t.conversationEntitiesSelector,y(n),((r,t)=>((0,e.denormalize)(t,[o.conversationSchema],{conversations:r})||[]).filter(Boolean))),R=(0,r.createSelector)(b(a.ServeTodayTab.UNREPLIED),(e=>(e.sort(((e,r)=>parseInt(r.latest_message_id)-parseInt(e.latest_message_id))),e))),O=(0,r.createSelector)(b(a.ServeTodayTab.AUTOREPLY),(e=>e.sort(((e,r)=>parseInt(r.latest_message_id)-parseInt(e.latest_message_id))))),I=(0,r.createSelector)(b(a.ServeTodayTab.MANUALREPLY),(e=>e.sort(((e,r)=>parseInt(r.latest_message_id)-parseInt(e.latest_message_id))))),E=(0,r.createSelector)(v,b(a.ServeTodayTab.PINNED),R,O,I,((e,r,t,o,n)=>{var s=[],c={[a.ServeTodayTab.PINNED]:r,[a.ServeTodayTab.UNREPLIED]:t,[a.ServeTodayTab.AUTOREPLY]:o,[a.ServeTodayTab.MANUALREPLY]:n},i=r.map((e=>e.id))||[];return a.ServeTodayFolders.forEach((r=>{var t=c[r];r!==a.ServeTodayTab.PINNED&&(t=t.filter((e=>!i.includes(e.id))),r===a.ServeTodayTab.AUTOREPLY&&(t=t.map((e=>l(l({},e),{},{isAutoReply:!0}))))),t.length&&(s=e[r]?s.concat([{key:r,id:"".concat(r,"Tab")},...t]):s.concat([{key:r,id:"".concat(r,"Tab")}]))})),s})),P=(0,r.createSelector)(E,(e=>e.filter((e=>!e.id.includes("Tab"))))),M=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationIds)||[]},A=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.pinnedConversationIds)||[]},j=(0,r.createSelector)(M,A,((e,r)=>{var t=e.filter((e=>!r.includes(e)));return r.concat(t)})),L=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.readRequestIds)||[]},w=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.missedReadNoticeCount)||0},D=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.inlocation)||!1},N=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.updateTimeNow)||"0"},U=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.currentConversationId)||null},k=e=>{var r;return(0,t.judgeUndefined)({defaultValue:!0,value:null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.currentConversationCanRead})},z=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.status)||""},B=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.direction)||""},F=(0,r.createSelector)(t.conversationEntitiesSelector,j,((r,t)=>((0,e.denormalize)(t,[o.conversationSchema],{conversations:r})||[]).filter(Boolean))),x=(0,r.createSelector)(F,U,((e,r)=>e.filter((e=>{var{id:t,unread_count:o}=e;return e&&(o>0||t===r)})))),Y=(0,r.createSelector)(F,(e=>e.filter((e=>e.isPinned)))),G=(0,r.createSelector)(F,(e=>e.filter((e=>e.status&&"closed"===e.status)))),V=(0,r.createSelector)(F,U,((e,r)=>e.filter((e=>{var{unreplied:t,id:o}=e;return void 0===t||t||!t&&o===r})))),H=(0,r.createSelector)(F,(e=>e.filter((e=>e.lack)).map((e=>e.id))||[])),J=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.filter)||"All"},K=(0,r.createSelector)(J,F,x,Y,G,V,((e,r,t,o,n,a)=>({All:r,Unread:t,Pinned:o,Closed:n,Unreplied:a}[e]))),q=(0,r.createSelector)(K,A,t.waitingTimeFilterSelector,J,((e,r,t,o)=>{var n=e.filter((e=>!r.includes(e.id))),a=e.filter((e=>r.includes(e.id)));return n.sort(((e,r)=>parseInt(r.latest_message_id)-parseInt(e.latest_message_id))),a.concat(n).filter((e=>void 0===e.faking))})),Q=(0,r.createSelector)(F,E,U,t.isSubAccountSelector,D,t.userEntitiesSelector,t.conversationEntitiesSelector,t.showChatServingFeatureSelector,((r,t,n,a,s,c,i,l)=>{var d=(l?[...r,...t]:r).find((e=>e.id===n))||{};if(s&&!d.id&&(d=(0,e.denormalize)(n,o.conversationSchema,{conversations:i})||{}),!a&&d.lack){var u=d.to_id,v=(0,e.denormalize)(u,o.userSchema,{users:c})||{},S={to_shop_id:v.shop_id,to_status:v.status,to_name:v.name||"-",to_avatar:v.avatar};return Object.assign(d,S)}return d})),W=(0,r.createSelector)(Q,(e=>{var{to_id:r}=e||{};return r||null})),X=(0,r.createSelector)(Q,t.shopsEntitiesSelector,((r,t)=>(0,e.denormalize)(r.shop_id,o.shopSchema,{shops:t})||{})),Z=(0,r.createSelector)(X,(e=>(null==e?void 0:e.country)||"SG")),$=(0,r.createSelector)(Q,(e=>e.shop_id)),ee=(0,r.createSelector)(Q,(e=>e.to_id)),re=(0,r.createSelector)(Q,(e=>e.status)),te=(0,r.createSelector)(Q,(e=>e.max_general_option_hide_time)),oe=n=>(0,r.createSelector)(t.conversationEntitiesSelector,(r=>(0,e.denormalize)(n,o.conversationSchema,{conversations:r})||{})),ne=e=>(0,r.createSelector)(oe(e),(e=>e.shop_id)),ae=e=>(0,r.createSelector)(F,E,t.showChatServingFeatureSelector,((r,t,o)=>{var n=o?[...r,...t]:r;return e.map((e=>n.find((r=>r.id===e)))).filter(Boolean)})),se=(0,r.createSelector)(Q,(e=>{var{shop_id:r}=e||{};return r||null})),ce=(0,r.createSelector)(t.userEntitiesSelector,Q,((r,t)=>t?(0,e.denormalize)(t.to_id,o.userSchema,{users:r}):{})),ie=(0,r.createSelector)(Q,(e=>{var{to_shop_id:r}=e||{};return r||null})),le=(0,r.createSelector)(ie,t.shopsEntitiesSelector,((r,t)=>(0,e.denormalize)(r,o.shopSchema,{shops:t})||{})),de=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.keyword)||""},ue=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.results)||[]},ve=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.searchStatus)||""},Se=(0,r.createSelector)(Q,(e=>e.translationAccess)),pe=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.listsHash)||{}},ge=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationBeenDeleted)||!1},fe=(0,r.createSelector)(Q,(e=>{var{to_name:r}=e||{};return r})),ye={hasSCAccess:!0,hasEditOrderAccess:!0,hasViewOrderAccess:!0,hasViewProductAccess:!0,hasEditVoucherAccess:!0,hasViewVoucherAccess:!0,hasViewRrOrderAccess:!0,hasOrderDetailAccess:!0},me=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.access)||ye},Te=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.isNavigateToUnreadMessage)||!1},he=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.navigateToUnreadMessageId)||""},Ce=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.pendingOffersCount)||{}},_e=(0,r.createSelector)(Q,Ce,((e,r)=>{var{shop_id:t,to_id:o}=e;return r["".concat(t,"_").concat(o)]||0})),be=e=>(0,r.createSelector)(oe(e),Ce,((e,r)=>{var{shop_id:t,to_id:o}=e;return r["".concat(t,"_").concat(o)]||0})),Re=n=>(0,r.createSelector)(ne(n),t.shopsEntitiesSelector,((r,t)=>{var n=(0,e.denormalize)(r,o.shopSchema,{shops:t})||{};return(null==n?void 0:n.country)||"SG"})),Oe=(0,r.createSelector)(t.isSubAccountSelector,t.currentUserIdSelector,X,((e,r,t)=>e?t.user_id:r)),Ie={unrepliedCount:0,duesoonCount:0,overdueCount:0,pinnedCount:0,unreadCount:0,serveTodayUnrepliedCount:0,serveTodayDuesoonCount:0,serveTodayOverdueCount:0,serveTodayPinnedCount:0,serveTodayBotRepliedCount:0,serveTodayManualRepliedCount:0},Ee=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.totalConversationsCount)||Ie},Pe=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationMark)||{}},Me=e=>(0,r.createSelector)(Pe,(r=>r[e])),Ae=(0,r.createSelector)(t.shopTranslationSettingsSelector,t.isSubAccountSelector,se,t.currentUserShopIdSelector,((e,r,t,o)=>{var n=r?t:o,{userStatus:a}=e[n]||{};return"frozen"===a})),je=e=>{var r;return null===(r=e.conversationReducer)||void 0===r?void 0:r.showLoadingMessagesMap},Le=(0,r.createSelector)(U,je,((e,r)=>{var t,o,n=r&&r[e],a=Object.entries(n||{})||[],s=a.some((([e,r])=>null==r?void 0:r.showLoading));return a.forEach((([e,r],n)=>{var{startTime:a}=r;(0===n||a<t)&&(t=a,o=r.isSend)})),{hasLoading:s,isSend:o,earliestStartTime:t}})),we=e=>{var r;return null===(r=e.conversationReducer)||void 0===r?void 0:r.redirectionInfo},De=(0,r.createSelector)(t.showChatServingFeatureSelector,j,_,((e,r,t)=>e?[...r,...t]:r));function Ne(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function Ue(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Ne(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ne(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ke,{MSG_TYPE_OFFER:ze,MSG_TYPE_ORDER:Be,MSG_TYPE_PRODUCT:Fe,MSG_TYPE_FAQ_UNSUPPORTED:xe,MSG_TYPE_FAQ_LIVEAGENT_PROMPT:Ye,MSG_TYPE_RATE_CARD:Ge}=a.MessageTypes,Ve=[Be,Fe],He=(0,r.createSelector)((e=>e),(e=>(e.messageReducer||{}).messagesRelatedMap||{})),Je=e=>{var r;return(null===(r=e.messageReducer)||void 0===r?void 0:r.videoMap)||{}},Ke=e=>(0,r.createSelector)(Je,(r=>JSON.parse(JSON.stringify(r[e]||{})))),qe=e=>(0,r.createSelector)(Je,(r=>Object.keys(r).find((t=>r[t].vid===e)))),Qe=n=>(0,r.createSelector)(t.messageEntitiesSelector,(r=>(0,e.denormalize)(n,o.messageSchema,{messages:r}))),We=(0,r.createSelector)(U,He,((e,r)=>r[e]||{all:[]})),Xe=e=>(0,r.createSelector)(He,(r=>r[e]||{all:[],sending:[],failed:[]})),Ze=(ke=e=>(0,r.createSelector)(Xe(e),oe(e),t.messageEntitiesSelector,((e,r,o)=>(0,t.getConversationLastMessage)(e,r,o))),function(){var e=Array.prototype.slice.call(arguments);return e in(ke.memoize=ke.memoize||{})?ke.memoize[e]:ke.memoize[e]=ke.apply(this,e)}),$e=(0,r.createSelector)(We,(e=>{var r=[...e.all||[]];return e.securityTipsMessageId&&r.push(e.securityTipsMessageId),r})),er=(0,r.createSelector)(We,(e=>e.sending||[])),rr=(0,r.createSelector)(We,(e=>e.failed||[])),tr=(0,r.createSelector)(t.messageEntitiesSelector,$e,((r,t)=>((0,e.denormalize)(t,[o.messageSchema],{messages:r})||[]).filter(Boolean))),or=(0,r.createSelector)(tr,(e=>e.reverse())),nr=(0,r.createSelector)(Q,or,((e,r)=>e?r.filter(Boolean).reduce(((e,r)=>{var{type:t,source_type:o,source_content:n,content:a}=r;if(!o||t===ze||[-1,0].includes(n["".concat(o,"_id")]))return e;if(Ve.includes(t)&&n){var s="".concat(t,"_id");if(a[s]===n[s])return e}var{lastSourceMessage:c,sourceList:i}=e;if(!i.length)return{sourceList:i.concat(r),lastSourceMessage:r};if(o===Fe){var l=null==n?void 0:n.product_id,d=c.source_content&&c.source_content.product_id;if(!l||d===l)return e}else if(o===Be){var u=null==n?void 0:n.order_id,v=c.source_content&&c.source_content.order_id;if(!u||[-1,0,v].includes(u))return e}return{sourceList:i.concat(r),lastSourceMessage:r}}),{sourceList:[],lastSourceMessage:null}).sourceList:[])),ar=(0,r.createSelector)(nr,(e=>e.map((e=>e.id)))),sr=(0,r.createSelector)(t.entitiesSelector,tr,((r,t)=>{var n=t.filter((e=>e&&e.type===ze)).map((e=>e.content.offer_id));return(0,e.denormalize)(n,[o.offerSchema],r)})),cr=(0,r.createSelector)(or,ar,er,rr,Q,t.rateCardEntitiesSelector,sr,((e,r,t,o,n,s,c)=>n?e.filter((e=>{if(!e)return!1;var{content:r,type:t}=e;return!(![xe,Ye].includes(t)&&(!r||r&&0===Object.keys(r).length))})).map((e=>{var n=t.includes(e.id)?a.MessageSendStatus.SENDING:o.includes(e.id)?a.MessageSendStatus.FAILED:e.send_status?a.MessageSendStatus.SUCCEED:null,i=r.includes(e.id),l=Object.assign({},e,{send_status:n,hasMessageSource:i}),{type:d,content:u={},message_option:v}=l;switch(d){case ze:var S=c.find((e=>e&&e.id===u.offer_id));l=Object.assign({},l,{textContent:S});break;case Ge:var p=s[u.card_id];p&&(l=Object.assign({},l,{textContent:p}))}return(0,a.hasTargetMessageOption)(v,a.MessageOption.MSG_OPT_CENSORED_BLACKLIST)&&(l=Ue(Ue({},l),{},{send_status:a.MessageSendStatus.FAILED,errorCode:a.MessageErrorCode.BLACKLIST})),l})):[])),ir=(0,r.createSelector)((e=>{var r;return null==e||null===(r=e.messageReducer)||void 0===r?void 0:r.reply}),(e=>e?e.toMessageId:{})),lr=(0,r.createSelector)(U,ir,((e,r)=>r[e]||"")),dr=(0,r.createSelector)(lr,t.messageEntitiesSelector,((r,t)=>(0,e.denormalize)(r,o.messageSchema,{messages:t}))),ur=(0,r.createSelector)(U,(e=>{var r;return(null===(r=e.mediaPreviewerReducer)||void 0===r?void 0:r.mediaMap)||{}}),((e,r)=>r[e]||[])),vr=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.feedback)||void 0},Sr=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.reconnectFlag)||!1},pr=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.noticesCount)||0}})(),i})(),e.exports=o(t(82677),t(20573),t(53402),t(96961),t(29494))},66633:function(e,r,t){"use strict";e.exports=t(78232)}}]);